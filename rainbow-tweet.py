from dotenv import load_dotenv
from requests_oauthlib import OAuth1Session
import os
import json
import random
import time

load_dotenv()

consumer_key = os.environ.get("CONSUMER_KEY")
consumer_secret = os.environ.get("CONSUMER_SECRET")

greetings = [
    'Plenty of SnowflakeZ for the picking!\n',
    'Find a unique Snowflake for a unique person\n',
    'Real Snowflakes aren\'t unique, but these SnowflakeZ are!\n',
    'Be ready for the next minting!\n',
    'It doesn\'t need to be the holidays to enjoy SnowflakeZ.\n',
    'What\'s your Favorite? Comment Below!\n',
    'Do you want to see more colors? Any other ideas? Comment Below!\n',
    'At the low floor price of 0.03 ETH, how could you pass it up?\n',
    'A Snowflake for your thoughts?\n',
    'I WANT YOU!.... to buy a Snowflake :p \n',
    'Make sure to check out the sister collection #BrokenSnowflakeZNFT !\n',
    'Do you wanna build a snowman? No?.... What if it were made of SnowflakeZ? :p\n',
    'A lot of people talk about Special SnowflakeZ these days, were they referring to these?\n',
    'With a name like \'Queen\', you\'d think I\'d have more Followers :p\n',
    'You know what\'s funny? I HATE the cold!\n',
    'ERROR 404: Joke not found\n',
    'Real Snowflakes would be a lot better with more colours\n',
    'It\'s time to shill! At least it\'s my own project :p\n',
    'Twitter is pretty cool these days, but it\'d be cooler with SnowflakeZ!\n',
    'I may not have a checkmark, but look at my art!\n',
    'GIF me a break, GIF me a break, break me off a piece of that Rainbow Snowflake!\n',
    '5 SnowflakeZ in every set, don\'t let Twitter\'s link system fool you\n',
    'There\'s No FlakeZ like SnowflakeZ!\n',
    'You must buy, You must buy, You must buuuuuy.... SnowflakeZ\n',
    'Hey, @opensea ! Shoutout for making a great platform for people to share their #NFTs :)\n',
    'SnowflakeZ keep falling on my head... Wait, it\'s supposed to be raindrops? Nah :p\n',
]

links = [
    '22176117569172953848175605113995043088088791683134261308094269189529242959873',
    '22176117569172953848175605113995043088088791683134261308094269190628754587649',
    '22176117569172953848175605113995043088088791683134261308094269191728266215425',
    '22176117569172953848175605113995043088088791683134261308094269192827777843201',
    '22176117569172953848175605113995043088088791683134261308094269193927289470977',
    '22176117569172953848175605113995043088088791683134261308094269195026801098753',
    '22176117569172953848175605113995043088088791683134261308094269196126312726529',
    '22176117569172953848175605113995043088088791683134261308094269197225824354305',
    '22176117569172953848175605113995043088088791683134261308094269198325335982081',
    '22176117569172953848175605113995043088088791683134261308094269199424847609857',
    '22176117569172953848175605113995043088088791683134261308094269200524359237633',
    '22176117569172953848175605113995043088088791683134261308094269201623870865409',
    '22176117569172953848175605113995043088088791683134261308094269203822894120961',
    '22176117569172953848175605113995043088088791683134261308094269204922405748737',
    '22176117569172953848175605113995043088088791683134261308094269206021917376513',
    '22176117569172953848175605113995043088088791683134261308094269207121429004289',
    '22176117569172953848175605113995043088088791683134261308094269208220940632065',
    '22176117569172953848175605113995043088088791683134261308094269209320452259841',
    '22176117569172953848175605113995043088088791683134261308094269210419963887617',
    '22176117569172953848175605113995043088088791683134261308094269211519475515393',
    '22176117569172953848175605113995043088088791683134261308094269212618987143169',
    '22176117569172953848175605113995043088088791683134261308094269213718498770945',
    '22176117569172953848175605113995043088088791683134261308094269214818010398721',
    '22176117569172953848175605113995043088088791683134261308094269215917522026497',
    '22176117569172953848175605113995043088088791683134261308094269223614103420929',
    '22176117569172953848175605113995043088088791683134261308094269222514591793153',
    '22176117569172953848175605113995043088088791683134261308094269221415080165377',
    '22176117569172953848175605113995043088088791683134261308094269220315568537601',
    '22176117569172953848175605113995043088088791683134261308094269219216056909825',
    '22176117569172953848175605113995043088088791683134261308094269218116545282049',
    '22176117569172953848175605113995043088088791683134261308094269217017033654273',
    '22176117569172953848175605113995043088088791683134261308094269224713615048705',
    '22176117569172953848175605113995043088088791683134261308094269225813126676481',
    '22176117569172953848175605113995043088088791683134261308094269226912638304257',
    '22176117569172953848175605113995043088088791683134261308094269228012149932033',
    '22176117569172953848175605113995043088088791683134261308094269229111661559809',
    '22176117569172953848175605113995043088088791683134261308094269230211173187585',
    '22176117569172953848175605113995043088088791683134261308094269231310684815361',
    '22176117569172953848175605113995043088088791683134261308094269239007266209793',
    '22176117569172953848175605113995043088088791683134261308094269237907754582017',
    '22176117569172953848175605113995043088088791683134261308094269236808242954241',
    '22176117569172953848175605113995043088088791683134261308094269235708731326465',
    '22176117569172953848175605113995043088088791683134261308094269233509708070913',
    '22176117569172953848175605113995043088088791683134261308094269232410196443137',
    '22176117569172953848175605113995043088088791683134261308094269240106777837569',
    '22176117569172953848175605113995043088088791683134261308094269241206289465345',
    '22176117569172953848175605113995043088088791683134261308094269242305801093121',
    '22176117569172953848175605113995043088088791683134261308094269243405312720897',
    '22176117569172953848175605113995043088088791683134261308094269244504824348673',
    '22176117569172953848175605113995043088088791683134261308094269245604335976449',
    '22176117569172953848175605113995043088088791683134261308094269246703847604225',
    '22176117569172953848175605113995043088088791683134261308094269254400428998657',
    '22176117569172953848175605113995043088088791683134261308094269253300917370881',
    '22176117569172953848175605113995043088088791683134261308094269252201405743105',
    '22176117569172953848175605113995043088088791683134261308094269251101894115329',
    '22176117569172953848175605113995043088088791683134261308094269250002382487553',
    '22176117569172953848175605113995043088088791683134261308094269248902870859777',
    '22176117569172953848175605113995043088088791683134261308094269247803359232001',
    '22176117569172953848175605113995043088088791683134261308094269256599452254209',
    '22176117569172953848175605113995043088088791683134261308094269257698963881985',
    '22176117569172953848175605113995043088088791683134261308094269258798475509761',
    '22176117569172953848175605113995043088088791683134261308094269259897987137537',
    '22176117569172953848175605113995043088088791683134261308094269260997498765313',
    '22176117569172953848175605113995043088088791683134261308094269262097010393089',
    '22176117569172953848175605113995043088088791683134261308094269263196522020865',
    '22176117569172953848175605113995043088088791683134261308094269264296033648641',
    '22176117569172953848175605113995043088088791683134261308094269265395545276417',
    '22176117569172953848175605113995043088088791683134261308094269266495056904193',
    '22176117569172953848175605113995043088088791683134261308094269268694080159745',
    '22176117569172953848175605113995043088088791683134261308094269269793591787521',
    '22176117569172953848175605113995043088088791683134261308094269270893103415297',
    '22176117569172953848175605113995043088088791683134261308094269271992615043073',
    '22176117569172953848175605113995043088088791683134261308094269273092126670849',
    '22176117569172953848175605113995043088088791683134261308094269274191638298625',
    '22176117569172953848175605113995043088088791683134261308094269275291149926401',
    '22176117569172953848175605113995043088088791683134261308094269276390661554177',
    '22176117569172953848175605113995043088088791683134261308094269277490173181953',
    '22176117569172953848175605113995043088088791683134261308094269278589684809729',
    '22176117569172953848175605113995043088088791683134261308094269279689196437505',
    '22176117569172953848175605113995043088088791683134261308094269280788708065281',
    '22176117569172953848175605113995043088088791683134261308094269281888219693057',
    '22176117569172953848175605113995043088088791683134261308094269282987731320833',
    '22176117569172953848175605113995043088088791683134261308094269284087242948609',
    '22176117569172953848175605113995043088088791683134261308094269285186754576385',
    '22176117569172953848175605113995043088088791683134261308094269286286266204161',
    '22176117569172953848175605113995043088088791683134261308094269287385777831937',
    '22176117569172953848175605113995043088088791683134261308094269288485289459713',
    '22176117569172953848175605113995043088088791683134261308094269289584801087489',
    '22176117569172953848175605113995043088088791683134261308094269290684312715265',
    '22176117569172953848175605113995043088088791683134261308094269291783824343041',
    '22176117569172953848175605113995043088088791683134261308094269292883335970817',
    '22176117569172953848175605113995043088088791683134261308094269293982847598593',
    '22176117569172953848175605113995043088088791683134261308094269295082359226369',
    '22176117569172953848175605113995043088088791683134261308094269296181870854145',
    '22176117569172953848175605113995043088088791683134261308094269297281382481921',
    '22176117569172953848175605113995043088088791683134261308094269298380894109697',
    '22176117569172953848175605113995043088088791683134261308094269299480405737473',
    '22176117569172953848175605113995043088088791683134261308094269300579917365249',
    '22176117569172953848175605113995043088088791683134261308094269301679428993025',
    '22176117569172953848175605113995043088088791683134261308094269302778940620801',
    '22176117569172953848175605113995043088088791683134261308094269303878452248577',
    '22176117569172953848175605113995043088088791683134261308094269304977963876353',
    '22176117569172953848175605113995043088088791683134261308094269306077475504129',
    '22176117569172953848175605113995043088088791683134261308094269307176987131905',
    '22176117569172953848175605113995043088088791683134261308094269308276498759681',
    '22176117569172953848175605113995043088088791683134261308094269309376010387457',
    '22176117569172953848175605113995043088088791683134261308094269310475522015233',
    '22176117569172953848175605113995043088088791683134261308094269311575033643009',
]

hashtags_mentions = "#RainbowSnowflakeZNFT #NFT\n#NFTCommunity #NFTProject"


# Get request token
request_token_url = "https://api.twitter.com/oauth/request_token?oauth_callback=oob&x_auth_access_type=write"
oauth = OAuth1Session(consumer_key, client_secret=consumer_secret)

try:
    fetch_response = oauth.fetch_request_token(request_token_url)
except ValueError:
    print(
        "There may have been an issue with the consumer_key or consumer_secret you entered."
    )

resource_owner_key = fetch_response.get("oauth_token")
resource_owner_secret = fetch_response.get("oauth_token_secret")
print("Got OAuth token: %s" % resource_owner_key)

# Get authorization
base_authorization_url = "https://api.twitter.com/oauth/authorize"
authorization_url = oauth.authorization_url(base_authorization_url)
print("Please go here and authorize: %s" % authorization_url)
verifier = input("Paste the PIN here: ")

# Get the access token
access_token_url = "https://api.twitter.com/oauth/access_token"
oauth = OAuth1Session(
    consumer_key,
    client_secret=consumer_secret,
    resource_owner_key=resource_owner_key,
    resource_owner_secret=resource_owner_secret,
    verifier=verifier,
)
oauth_tokens = oauth.fetch_access_token(access_token_url)

access_token = oauth_tokens["oauth_token"]
access_token_secret = oauth_tokens["oauth_token_secret"]

# Make the request
oauth = OAuth1Session(
    consumer_key,
    client_secret=consumer_secret,
    resource_owner_key=access_token,
    resource_owner_secret=access_token_secret,
)


def sendTweet():

    payload = {
        "text": random.choice(greetings) + 'https://opensea.io/assets/ethereum/0x495f947276749ce646f68ac8c248420045cb7b5e/' + random.choice(links) + "\n" + hashtags_mentions
    }


    #Making the request
    response = oauth.post(
        "https://api.twitter.com/2/tweets",
        json=payload,
    )

    if response.status_code != 201:
        raise Exception(
            "Request returned an error: {} {}".format(response.status_code, response.text)
        )

    # print("Response code: {}".format(response.status_code))

    # Saving the response as JSON
    json_response = response.json()
    # print(json.dumps(json_response, indent=4, sort_keys=True))
    print('\n'+json_response['data']['text'])

if __name__ == '__main__':
    for i in range(30):
        sendTweet()
        # timing = random.randint(180,300)
        print('Tweet # '+str(i+1))
        # print('Seconds to next: '+str(timing))
        # time.sleep(timing)
        time.sleep(300)